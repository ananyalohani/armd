(function(f){typeof define=="function"&&define.amd?define(f):f()})(function(){"use strict";var f;(function(e){e[e.All=0]="All",e[e.Two=1]="Two",e[e.One=2]="One"})(f||(f={}));let u,y;function D(e,n){if(e.nodeType!==Node.ELEMENT_NODE)throw new Error("Can't generate CSS selector for non-element node type.");if(e.tagName.toLowerCase()==="html")return"html";const t={root:document.body,idName:i=>!0,className:i=>!0,tagName:i=>!0,attr:(i,s)=>!1,seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4};u=Object.assign(Object.assign({},t),n),y=q(u.root,t);let r=w(e,f.All,()=>w(e,f.Two,()=>w(e,f.One)));if(r){const i=T(C(r,e));return i.length>0&&(r=i[0]),h(r)}else throw new Error("Selector was not found.")}function q(e,n){return e.nodeType===Node.DOCUMENT_NODE?e:e===n.root?e.ownerDocument:e}function w(e,n,t){let r=null,i=[],s=e,a=0;for(;s&&s!==u.root.parentElement;){let l=g(M(s))||g(...L(s))||g(...I(s))||g(X(s))||[Y()];const d=U(s);if(n===f.All)d&&(l=l.concat(l.filter(v).map(o=>E(o,d))));else if(n===f.Two)l=l.slice(0,1),d&&(l=l.concat(l.filter(v).map(o=>E(o,d))));else if(n===f.One){const[o]=l=l.slice(0,1);d&&v(o)&&(l=[E(o,d)])}for(let o of l)o.level=a;if(i.push(l),i.length>=u.seedMinLength&&(r=x(i,t),r))break;s=s.parentElement,a++}return r||(r=x(i,t)),r}function x(e,n){const t=T(O(e));if(t.length>u.threshold)return n?n():null;for(let r of t)if(b(r))return r;return null}function h(e){let n=e[0],t=n.name;for(let r=1;r<e.length;r++){const i=e[r].level||0;n.level===i-1?t=`${e[r].name} > ${t}`:t=`${e[r].name} ${t}`,n=e[r]}return t}function A(e){return e.map(n=>n.penalty).reduce((n,t)=>n+t,0)}function b(e){switch(y.querySelectorAll(h(e)).length){case 0:throw new Error(`Can't select any node with this selector: ${h(e)}`);case 1:return!0;default:return!1}}function M(e){const n=e.getAttribute("id");return n&&u.idName(n)?{name:"#"+p(n,{isIdentifier:!0}),penalty:0}:null}function L(e){return Array.from(e.attributes).filter(t=>u.attr(t.name,t.value)).map(t=>({name:"["+p(t.name,{isIdentifier:!0})+'="'+p(t.value)+'"]',penalty:.5}))}function I(e){return Array.from(e.classList).filter(u.className).map(t=>({name:"."+p(t,{isIdentifier:!0}),penalty:1}))}function X(e){const n=e.tagName.toLowerCase();return u.tagName(n)?{name:n,penalty:2}:null}function Y(){return{name:"*",penalty:3}}function U(e){const n=e.parentNode;if(!n)return null;let t=n.firstChild;if(!t)return null;let r=0;for(;t&&(t.nodeType===Node.ELEMENT_NODE&&r++,t!==e);)t=t.nextSibling;return r}function E(e,n){return{name:e.name+`:nth-child(${n})`,penalty:e.penalty+1}}function v(e){return e.name!=="html"&&!e.name.startsWith("#")}function g(...e){const n=e.filter(j);return n.length>0?n:null}function j(e){return e!=null}function*O(e,n=[]){if(e.length>0)for(let t of e[0])yield*O(e.slice(1,e.length),n.concat(t));else yield n}function T(e){return Array.from(e).sort((n,t)=>A(n)-A(t))}function*C(e,n,t={counter:0,visited:new Map}){if(e.length>2&&e.length>u.optimizedMinLength)for(let r=1;r<e.length-1;r++){if(t.counter>u.maxNumberOfTries)return;t.counter+=1;const i=[...e];i.splice(r,1);const s=h(i);if(t.visited.has(s))return;b(i)&&z(i,n)&&(yield i,t.visited.set(s,!0),yield*C(i,n,t))}}function z(e,n){return y.querySelector(h(e))===n}const P=/[ -,\.\/:-@\[-\^`\{-~]/,$=/[ -,\.\/:-@\[\]\^`\{-~]/,H=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,W={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1};function p(e,n={}){const t=Object.assign(Object.assign({},W),n);t.quotes!="single"&&t.quotes!="double"&&(t.quotes="single");const r=t.quotes=="double"?'"':"'",i=t.isIdentifier,s=e.charAt(0);let a="",l=0;const d=e.length;for(;l<d;){const o=e.charAt(l++);let c=o.charCodeAt(0),m;if(c<32||c>126){if(c>=55296&&c<=56319&&l<d){const S=e.charCodeAt(l++);(S&64512)==56320?c=((c&1023)<<10)+(S&1023)+65536:l--}m="\\"+c.toString(16).toUpperCase()+" "}else t.escapeEverything?P.test(o)?m="\\"+o:m="\\"+c.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(o)?m="\\"+c.toString(16).toUpperCase()+" ":o=="\\"||!i&&(o=='"'&&r==o||o=="'"&&r==o)||i&&$.test(o)?m="\\"+o:m=o;a+=m}return i&&(/^-[-\d]/.test(a)?a="\\-"+a.slice(1):/\d/.test(s)&&(a="\\3"+s+" "+a.slice(1))),a=a.replace(H,function(o,c,m){return c&&c.length%2?o:(c||"")+m}),!i&&t.wrap?r+a+r:a}function N(e,n,t){n.forEach(r=>e.addEventListener(r,t,!1))}const _=e=>e?.nodeType===Node.ELEMENT_NODE,F=e=>t=>{console.log(t.type,t.destination,t.target);const r={event:t.type,timestamp:Date.now(),properties:{referrer:document.referrer,clientX:t.clientX,clientY:t.clientY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY,host:window.location.hostname,pathname:window.location.pathname,userAgent:navigator.userAgent,userAgentData:JSON.stringify(navigator.userAgentData),clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight,screenWidth:window.screen.width,screenHeight:window.screen.height,selector:_(t.target)?D(t.target):void 0,innerText:t.target.innerText||void 0,destination:t.destination||void 0}};console.log(t.type,{eventInfo:r}),fetch(`${e}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:r}),keepalive:!0})},J=({base:e})=>{const n=F(e);document.addEventListener("DOMContentLoaded",async()=>{N(document,["click","dblclick","scroll"],n),N(navigation,["navigate"],n),N(window,["resize","scroll","pageshow","pagehide","contextmenu","beforeunload"],n)})};window.startArmd=J});
